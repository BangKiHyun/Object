# 책임 주도 설계

## 책임 주도 설계 원칙

- ### 데이터보다 행동을 먼저 결정하라

  - 객체에게 중요한 건 외부에 제공하는 행동
  - 클라이언트 관점에서 객체가 수행하는 행동이란 곧 객체의 책임을 의미

- ### 협력이라는 문맥 안에서 책임을 결정하라

  - 책임은 객체의 입장이 아니라 **객체가 참여하는 협력에 적합**해야 한다.
    - 객체의 책임을 어떻게 식별해야 하는가에 대한 힌트를 제공
  - 객체가 메시지를 선택하는 것이 아니라 메시지가 객체를 선택하게 해야 한다.

핵심은 설계를 진행하는 동안 데이터가 아니라 **객체의 책임과 협력에 초점**을 맞추라는 것이다.

</br >

## GRASP 패턴: 객체에게 책임을 할당하는 패턴

### INFORMATION EXPERT 패턴(정보 전문가)

책임을 수행하는 데 필요한 정보를 가지고 있는 객체에게 할당하는 것

- ### Why?

  - 정보를 알고 있는 객체만이 책임을 어떻게 수행할지 스스로 결정할 수 있다.
  - 정보와 행동을 최대한 가까운 곳에 위치시키기 때문에 캡슐화를 유지할 수 있다.
  - 필요한 정보를 가진 객체들로 책임이 분산되기 떄문에 응집력 있고, 이해하기 쉬워진다.
  - 즉, 높은 응집도와 낮은 결합도를 만들 수 있다.

</br >

### LOW COUPLING 패턴(낮은 결합도)

결합도가 늦게 유지되도록 책임을 할당하는 것

- ### Why?

  - 의존성을 낮추고 변경용이하게 하여 재사용성을 증가시킬 수 있다.
  - 설계 결정을 평가할 때 적용할 수 있는 평가원리이다.
  - 현재의 책임 할당을 검토하거나 여러 설계 대안들이 있을 때 낮은 결합도를 유지할 수 있는 설계를 선택하라.

### HIGH COHESION 패턴(높은 응집도)

높은 응집도를 유지할 수 있게 책임을 할당하는 것

- ### Why?

  - 설계 결정을 평가할 때 적용할 수 있는 평가원리다.
  - 현재의 책임 할당을 검토하고 있거나 여러 설계 대안 중 하나를 선택해야 한다면 높은 응집도를 유지할 수 있는 설계를 선택하라.

LOW COUPLING 패턴과 HIGH COHESION 패턴은 설계를 진행하면서 **책임과 협력의 품질을 검토하는 데 사용할 수 있는 중요한 평가 기준**이다. 또한 두 관점에서 전체적인 설계 품질을 검토하면 **재사용 가능하고 유연한 설계를 얻을 수 있다.**

</br >

### CREATOR 패턴

어떤 방식으로든 생성되는 객체와 연결되거나 관련될 필요가 있는 객체에 해당 객체를 생성할 책임을 맡기는 것 

객체를 생성할 책임을 어떤 객체에게 할당할지에 대한 지침을 제공해 준다.

- ### 객체 A를 생성할 때 다음 조건을 최대한 많이 만족하는 B 객체에게 책임을 할당하라

  - B가 A 객체를 포함하거나 참조한다.
  - B가 A 객체를 기록한다.
  - B가 A 객체를 긴밀하게 사용한다.
  - B가 A 객체를 초기화하는 데 필요한 데이터를 가지고 있다(이 경우 B는 A에 대한 정보 전문가)

이미 결합돼 있는 객체에게 생성 책임을 할당하는 것은 **설계의 전체적인 결합도에 영향을 미치지 않기 때문에, 낮은 결합도를 유지할 수 있다.**

</br >

### POLYMORPHISM 패턴

객체의 타입에 따라 변하는 로직이 있을 때 타입을 명시적으로(DiscountCondition)으로 정하고 각 타입에 다형적(Sequence, Period)으로 행동하는 책임을 할당하는 것

- ### Why?

  - 암시적인 타입을 명시적인 클래스로 정의하고 행동을 나눔으로써 응집도 문제를 해결할 수 있음
  - 다형성을 이용하면 확장성 좋은 설계가 됨
  - 프로그램을 is-else 또는 switch-case 등의 조건 논리를 사용했을 때 새로운 변화가 일어난 경우 조건 논리를 수정해야 함
    - 프로그램을 수정하기 어렵고 변경에 취약해짐

**하나의 클래스가 여러 타입의 행동을 구현하고 있는 것처럼 보인다면 책임을 분산시키자!**

</br >

### PROTECTED VARIATIONS 패턴

변화가 예상되는 불안정한 지점들을 식별하고 그 주위에 안정된 인터페이스를 형성하도록 책임을 할당하는 것

> GOF94
>
> 설계에서 변하는 것이 무엇인지 고려하고 변하는 개념을 캡슐화하라

**예측 가능한 변경으로인해 여러 클래스들이 불안정해진다면 안정적인 인터페이스 뒤로 변경을 캡슐화하자!**

</br >

## 변경과 유연성

### 변경에 대비할 수 있는 두 가지 방법

1. 코드를 이해하고 수정하기 쉽도록 최대한 단순하게 설계하는 것
   - 대부분의 경우 이 방법이 좋다.
2. 코드를 수정하지 않고도 변경을 수용할 수 있도록 코드를 더 유연하게 만드는 것
   - 유사한 변경이 반복적으로 발생하고 있다면 복잡성이 상승하더라도 유연성을 추가하는 이 방법이 좋다.



